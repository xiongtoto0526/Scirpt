import { bundleStore, providerStore } from '../writers';
let _parsers = {};
export class DecoratedModule {
    constructor(name, modules = false) {
        this.name = name;
        if (modules) {
            this.moduleList(modules);
            this._module = angular.module(name, this._dependencies);
        }
        else {
            this._module = angular.module(name);
        }
    }
    add(...providers) {
        for (let provider of providers) {
            if (!providerStore.has('type', provider)) {
                throw new Error(`Cannot read provider metadata. Are you adding a class that hasn't been decorated yet?`);
            }
            let type = providerStore.get('type', provider);
            let name = providerStore.get('name', provider);
            let inject = bundleStore.get('$inject', provider) || [];
            if (_parsers[type]) {
                _parsers[type](provider, name, inject, this._module);
            }
            else {
                throw new Error(`No parser registered for type '${type}'`);
            }
        }
        return this;
    }
    publish() {
        return this._module;
    }
    moduleList(modules) {
        this._dependencies = [];
        if (modules && modules.length !== 0) {
            for (let i = 0; i < modules.length; i++) {
                if (typeof modules[i] === 'string') {
                    this._dependencies.push(modules[i]);
                }
                else if (modules[i] && modules[i].name) {
                    this._dependencies.push(modules[i].name);
                }
                else {
                    throw new Error(`Cannot read module: Unknown module in ${this.name}`);
                }
            }
        }
    }
    config(configFunc) {
        this._module.config(configFunc);
        return this;
    }
    run(runFunc) {
        this._module.run(runFunc);
        return this;
    }
    value(name, value) {
        this._module.value(name, value);
        return this;
    }
    constant(name, value) {
        this._module.constant(name, value);
        return this;
    }
}
let Module = function (name, modules) {
    return new DecoratedModule(name, modules);
};
Module.addProvider = function (providerType, parser) {
    _parsers[providerType] = parser;
};
Module.getParser = function (providerType) {
    return _parsers[providerType];
};
export default Module;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jbGFzc2VzL21vZHVsZS50cyJdLCJuYW1lcyI6WyJEZWNvcmF0ZWRNb2R1bGUiLCJEZWNvcmF0ZWRNb2R1bGUuY29uc3RydWN0b3IiLCJEZWNvcmF0ZWRNb2R1bGUuYWRkIiwiRGVjb3JhdGVkTW9kdWxlLnB1Ymxpc2giLCJEZWNvcmF0ZWRNb2R1bGUubW9kdWxlTGlzdCIsIkRlY29yYXRlZE1vZHVsZS5jb25maWciLCJEZWNvcmF0ZWRNb2R1bGUucnVuIiwiRGVjb3JhdGVkTW9kdWxlLnZhbHVlIiwiRGVjb3JhdGVkTW9kdWxlLmNvbnN0YW50Il0sIm1hcHBpbmdzIjoiT0FXTyxFQUFDLFdBQVcsRUFBRSxhQUFhLEVBQUMsTUFBTSxZQUFZO0FBR3JELElBQUksUUFBUSxHQUFRLEVBQUUsQ0FBQztBQUl2QjtJQUlDQSxZQUFtQkEsSUFBWUEsRUFBRUEsT0FBT0EsR0FBUUEsS0FBS0E7UUFBbENDLFNBQUlBLEdBQUpBLElBQUlBLENBQVFBO1FBRzlCQSxFQUFFQSxDQUFBQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUNYQSxDQUFDQTtZQUVBQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQTtZQUV6QkEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsT0FBT0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsRUFBRUEsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0E7UUFDekRBLENBQUNBO1FBQ0RBLElBQUlBLENBQ0pBLENBQUNBO1lBRUFBLElBQUlBLENBQUNBLE9BQU9BLEdBQUdBLE9BQU9BLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1FBQ3JDQSxDQUFDQTtJQUNGQSxDQUFDQTtJQUdERCxHQUFHQSxDQUFDQSxHQUFHQSxTQUFnQkE7UUFHdEJFLEdBQUdBLENBQUFBLENBQUNBLEdBQUdBLENBQUNBLFFBQVFBLElBQUlBLFNBQVNBLENBQUNBLENBQzlCQSxDQUFDQTtZQUlBQSxFQUFFQSxDQUFBQSxDQUFF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QUNBLEdBQUdBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1FBRTFCQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQTtJQUNiQSxDQUFDQTtJQUdETixLQUFLQSxDQUFDQSxJQUFZQSxFQUFFQSxLQUFVQTtRQUM3Qk8sSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFFaENBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO0lBQ2JBLENBQUNBO0lBR0RQLFFBQVFBLENBQUNBLElBQVlBLEVBQUVBLEtBQVVBO1FBQ2hDUSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxRQUFRQSxDQUFDQSxJQUFJQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUVuQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7SUFDYkEsQ0FBQ0E7QUFDRlIsQ0FBQ0E7QUFJRCxJQUFJLE1BQU0sR0FBUSxVQUFTLElBQVksRUFBRSxPQUFhO0lBQ3JELE1BQU0sQ0FBQyxJQUFJLGVBQWUsQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDM0MsQ0FBQyxDQUFDO0FBS0YsTUFBTSxDQUFDLFdBQVcsR0FBRyxVQUFTLFlBQW9CLEVBQUUsTUFBVztJQUM5RCxRQUFRLENBQUMsWUFBWSxDQUFDLEdBQUcsTUFBTSxDQUFDO0FBQ2pDLENBQUMsQ0FBQztBQUlGLE1BQU0sQ0FBQyxTQUFTLEdBQUcsVUFBUyxZQUFvQjtJQUMvQyxNQUFNLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQy9CLENBQUMsQ0FBQztBQUlGLGVBQWUsTUFBTSxDQUFDIiwiZmlsZSI6ImxpYi9jbGFzc2VzL21vZHVsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vICMgTW9kdWxlXG4vLyBBIHRoaW4gd3JhcHBlciBhcm91bmQgYGFuZ3VsYXIubW9kdWxlYCBmb3IgdHJhbnNmb3JtaW5nIGFubm90YXRlZCBjbGFzc2VzIGludG9cbi8vIGFuZ3VsYXIgcHJvdmlkZXJzXG4vL1xuLy8gIyMgU2V0dXBcbi8vIFVubGVzcyB5b3UgYXJlIHVzaW5nIGEgc2hpbSwgYWxsIG9mZmljaWFsIGRpc3RyaWJ1dGlvbnMgb2YgQW5ndWxhci5qcyBpbnN0YWxsXG4vLyBgYW5ndWxhcmAgb24gYHdpbmRvd2AuIEl0IGlzIHNhZmUgdG8gYXNzdW1lIGl0IHdpbGwgYWx3YXlzIGJlIHRoZXJlLlxuLyogZ2xvYmFsIGFuZ3VsYXIgKi9cbi8vIFRoZSBjb3JlIG9mIHRoZSBtb2R1bGUgc3lzdGVtIHJlbGllcyBvbiBzcGVjaWFsIG1ldGFkYXRhIHdyaXRlcnMuIFRoZXkgd3JpdGVcbi8vIG5hbWVzcGFjZWQgbWV0YWRhdGEgdG8gYSBjbGFzcy4gRWFjaCB3cml0ZXIgaXMgcmVzcG9uc2libGUgZm9yIGhhbmRsaW5nIHNvbWVcbi8vIHN1YnNldCBvZiB1c2VmdWwgaW5mb3JtYXRpb25cbmltcG9ydCB7YnVuZGxlU3RvcmUsIHByb3ZpZGVyU3RvcmV9IGZyb20gJy4uL3dyaXRlcnMnO1xuXG4vLyBBIHZlcnkgc2ltcGxlIG1hcCBob2xkaW5nIHRoZSBwYXJzZXJzIGZvciBlYWNoIHByb3ZpZGVyLiBNb3JlIG9uIHRoaXMgbGF0ZXIuXG5sZXQgX3BhcnNlcnM6IGFueSA9IHt9O1xuXG4vLyAjIyBEZWNvcmF0ZWRNb2R1bGUgY2xhc3Ncbi8vIERlZmluZSB0aGUgTW9kdWxlIHdyYXBwZXIgY2xhc3MuXG5leHBvcnQgY2xhc3MgRGVjb3JhdGVkTW9kdWxle1xuXHRwcml2YXRlIF9tb2R1bGU6IG5nLklNb2R1bGU7XG5cdHByaXZhdGUgX2RlcGVuZGVuY2llczogYW55W107XG5cdFxuXHRjb25zdHJ1Y3RvcihwdWJsaWMgbmFtZTogc3RyaW5nLCBtb2R1bGVzOiBhbnkgPSBmYWxzZSl7XG5cdFx0Ly8gYGFuZ3VsYXIubW9kdWxlYCB3b3JrcyBlaXRoZXIgYnkgY3JlYXRpbmcgYSBuZXcgbW9kdWxlIHZpYSBhbiBhcnJheVxuXHRcdC8vIG9mIGRlcGVuZGVuY2llcyBvciBieSByZWZlcmVuY2Ugd2l0aG91dCB0aGUgZGVwZW5kZW5jaWVzIGFycmF5XG5cdFx0aWYobW9kdWxlcylcblx0XHR7XG5cdFx0XHQvLyBwYXJzZSB0aGUgbW9kdWxlIGxpc3QgdG8gY3JlYXRlIGFuIGFycmF5IG9mIGp1c3Qgc3RyaW5nc1xuXHRcdFx0dGhpcy5tb2R1bGVMaXN0KG1vZHVsZXMpO1xuXHRcdFx0Ly8gQ3JlYXRlIHRoZSBhbmd1bGFyIG1vZHVsZS5cblx0XHRcdHRoaXMuX21vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKG5hbWUsIHRoaXMuX2RlcGVuZGVuY2llcyk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHQvLyBJZiBubyBkZXBlbmRlbmNpZXMgd2VyZSBwYXNzZWQsIGFjY2VzcyB0aGUgbW9kdWxlIGJ5IHJlZmVyZW5jZVxuXHRcdFx0dGhpcy5fbW9kdWxlID0gYW5ndWxhci5tb2R1bGUobmFtZSk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gVGhpcyBpcyB3aGVyZSB5b3UgYWRkIGFuIGFubm90YXRlZCBjbGFzcyB0byB0aGUgQW5ndWxhciBtb2R1bGVcblx0YWRkKC4uLnByb3ZpZGVyczogYW55W10pOiBEZWNvcmF0ZWRNb2R1bGUge1xuXHRcdC8vIFdlIHVzZWQgYSByZXN0IHBhcmFtZXRlciBzbyB0aGF0IHlvdSBjYW4gYWRkIG11bHRpcGxlIHByb3ZpZGVycyBhdCBvbmNlLlxuXHRcdC8vIFNvIHdlIG11c3QgaXRlcmF0ZSBvdmVyIG91ciBhcnJheSBvZiBwcm92aWRlcnMuXG5cdFx0Zm9yKGxldCBwcm92aWRlciBvZiBwcm92aWRlcnMpXG5cdFx0e1xuXHRcdFx0Ly8gVGhlIHByb3ZpZGVyU3RvcmUgY29udGFpbnMgdGhlIHR5cGUgb2YgcHJvdmlkZXIgdGhlIGNsYXNzIHdpbGwgYmUgdHJhbnNmb3JtZWRcblx0XHRcdC8vIGludG8gYXMgd2VsbCBhcyB0aGUgbmFtZSBvZiB0aGUgZXZlbnR1YWwgcHJvdmlkZXIuIElmIHRoaXMgaW5mb3JtYXRpb24gaGFzXG5cdFx0XHQvLyBub3QgYmVlbiBzZXQgb24gdGhlIGNsYXNzLCB0aGVuIHdlIGFyZW4ndCBkZWFsaW5nIHdpdGggYSBkZWNvcmF0ZWQgY2xhc3MuXG5cdFx0XHRpZiggIXByb3ZpZGVyU3RvcmUuaGFzKCd0eXBlJywgcHJvdmlkZXIpICl7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHJlYWQgcHJvdmlkZXIgbWV0YWRhdGEuIEFyZSB5b3UgYWRkaW5nIGEgY2xhc3MgdGhhdCBoYXNuJ3QgYmVlbiBkZWNvcmF0ZWQgeWV0P2ApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHcmFiIHRoZSB0eXBlIG9mIHByb3ZpZGVyXG5cdFx0XHRsZXQgdHlwZSA9IHByb3ZpZGVyU3RvcmUuZ2V0KCd0eXBlJywgcHJvdmlkZXIpO1xuXHRcdFx0Ly8gLi4uYW5kIHRoZSBuYW1lIG9mIHRoZSBwcm92aWRlclxuXHRcdFx0bGV0IG5hbWUgPSBwcm92aWRlclN0b3JlLmdldCgnbmFtZScsIHByb3ZpZGVyKTtcblx0XHRcdC8vIFRoaXMgaXMgdGhlIGluamVjdGlvbiBhcnJheSB1c2VkIGJ5IGFuZ3VsYXIncyBgJGluamVjdG9yLmludm9rZWAuIFRoaXMgYXJyYXlcblx0XHRcdC8vIGlzIGp1c3QgYSBsaXN0IG9mIHN0cmluZ3MgdGhhdCB3aWxsIGJlIGluamVjdGVkXG5cdFx0XHRsZXQgaW5qZWN0ID0gYnVuZGxlU3RvcmUuZ2V0KCckaW5qZWN0JywgcHJvdmlkZXIpIHx8IFtdO1xuXG5cdFx0XHQvLyBXZSB1c2UgdGhlIHByb3ZpZGVyIHR5cGUgdG8gZGV0ZXJtaW5lIHdoaWNoIHBhcnNlciB3aWxsIGhhbmRsZSB0aGUgY2xhc3Ncblx0XHRcdGlmKF9wYXJzZXJzW3R5cGVdKXtcblx0XHRcdFx0Ly8gRXhlY3V0ZSB0aGUgcGFyc2VyIHBhc3NpbmcgdGhlIGNsYXNzLCBuYW1lIG9mIHRoZSBwcm92aWRlciwgaW5qZWN0aW9uXG5cdFx0XHRcdC8vIGFycmF5LCBhbmQgdGhlIHJhdyBgYW5ndWxhci5tb2R1bGVgIHdlIGRlZmluZWQgaW4gdGhlIGNvbnN0cnVjdG9yLlxuXHRcdFx0XHRfcGFyc2Vyc1t0eXBlXShwcm92aWRlciwgbmFtZSwgaW5qZWN0LCB0aGlzLl9tb2R1bGUpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZXtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBObyBwYXJzZXIgcmVnaXN0ZXJlZCBmb3IgdHlwZSAnJHt0eXBlfSdgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdC8vIERlYWQgY29kZSBmcm9tIGFuZ3VsYXItZGVjb3JhdG9ycyB0aGF0IHNob3VsZCBwcm9iYWJseSBiZSByZW1vdmVkLiBKdXN0IHJldHVybnNcblx0Ly8gdGhlIHJhdyBhbmd1bGFyLm1vZHVsZS5cblx0cHVibGlzaCgpOiBuZy5JTW9kdWxle1xuXHRcdHJldHVybiB0aGlzLl9tb2R1bGU7XG5cdH1cblxuXHQvLyBQYXJzZXMgdGhlIGFycmF5IG9mIG1vZHVsZXNcblx0bW9kdWxlTGlzdChtb2R1bGVzOiBhbnlbXSl7XG5cdFx0Ly8gU2V0dXAgdGhlIGRlcGVuZGVuY3kgYXJyYXlcblx0XHR0aGlzLl9kZXBlbmRlbmNpZXMgPSBbXTtcblxuXHRcdGlmKG1vZHVsZXMgJiYgbW9kdWxlcy5sZW5ndGggIT09IDApe1xuXHRcdFx0Ly8gSXRlcmF0ZSBvdmVyIHRoZSBtb2R1bGVzLiBXb3VsZCBiZSBiZXR0ZXIgZG9uZSB2aWEgYG1vZHVsZXMubWFwYCwgYnV0XG5cdFx0XHQvLyBpdCB3b3Jrcy5cblx0XHRcdGZvcihsZXQgaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKVxuXHRcdFx0e1xuXHRcdFx0XHQvLyBJZiB0aGUgbW9kdWxlIGlzIGEgc3RyaW5nIChpLmUuICd1aS1yb3V0ZXInIG9yICduZ0FyaWEnKSB0aGVuIHdlIGFyZVxuXHRcdFx0XHQvLyBhbHJlYWR5IHNldFxuXHRcdFx0XHRpZih0eXBlb2YgbW9kdWxlc1tpXSA9PT0gJ3N0cmluZycpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGlzLl9kZXBlbmRlbmNpZXMucHVzaChtb2R1bGVzW2ldKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBJZiBpdCBpc24ndCBhIHN0cmluZyBidXQgaGFzIGEgbmFtZSB0aGVuIHVzZSB0aGUgbmFtZSBpbnN0ZWFkLiBSYXdcblx0XHRcdFx0Ly8gYGFuZ3VsYXIubW9kdWxlYHMgcHJvdmlkZSB0aGUgbmFtZSBoZXJlIGFzIGRvZXMgb3VyIHJlaW1wbGVtZW50YXRpb24uXG5cdFx0XHRcdGVsc2UgaWYobW9kdWxlc1tpXSAmJiBtb2R1bGVzW2ldLm5hbWUpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGlzLl9kZXBlbmRlbmNpZXMucHVzaChtb2R1bGVzW2ldLm5hbWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIElmIG5laXRoZXIgY2FzZSB3YXMgbWV0LCB0aHJvdyBhbiBlcnJvclxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCByZWFkIG1vZHVsZTogVW5rbm93biBtb2R1bGUgaW4gJHt0aGlzLm5hbWV9YCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBBbGlhcyBvdmVyIHRoZSByYXcgY29uZmlnIGZ1bmN0aW9uXG5cdGNvbmZpZyhjb25maWdGdW5jOiBhbnkpOiBEZWNvcmF0ZWRNb2R1bGV7XG5cdFx0dGhpcy5fbW9kdWxlLmNvbmZpZyhjb25maWdGdW5jKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0Ly8gQWxpYXMgb3ZlciB0aGUgcmF3IHJ1biBmdW5jdGlvblxuXHRydW4ocnVuRnVuYzogYW55KTogRGVjb3JhdGVkTW9kdWxle1xuXHRcdHRoaXMuX21vZHVsZS5ydW4ocnVuRnVuYyk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdC8vIEFsaWFzIGZvciB0aGUgdmFsdWUgcHJvdmlkZXJcblx0dmFsdWUobmFtZTogc3RyaW5nLCB2YWx1ZTogYW55KTogRGVjb3JhdGVkTW9kdWxle1xuXHRcdHRoaXMuX21vZHVsZS52YWx1ZShuYW1lLCB2YWx1ZSk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdC8vIEFsaWFzIGZvciB0aGUgY29uc3RhbnQgcHJvdmlkZXJcblx0Y29uc3RhbnQobmFtZTogc3RyaW5nLCB2YWx1ZTogYW55KTogRGVjb3JhdGVkTW9kdWxle1xuXHRcdHRoaXMuX21vZHVsZS5jb25zdGFudChuYW1lLCB2YWx1ZSk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufVxuXG4vLyBCZWN1YXNlIEkgZGV0ZXJtaW5lZCBgZXhwb3J0IGRlZmF1bHQgbmV3IE1vZHVsZWAgdG8gYmUgdG9vIGxvbmcsIHdyYXAgdGhlXG4vLyBgRGVjb3JhdGVkTW9kdWxlYCBjbGFzcyBpbiBhIHNpbXBsZSBmYWN0b3J5IGZ1bmN0aW9uLlxubGV0IE1vZHVsZTogYW55ID0gZnVuY3Rpb24obmFtZTogc3RyaW5nLCBtb2R1bGVzPzogYW55KTogRGVjb3JhdGVkTW9kdWxle1xuXHRyZXR1cm4gbmV3IERlY29yYXRlZE1vZHVsZShuYW1lLCBtb2R1bGVzKTtcbn07XG5cbi8vIEEgc3RhdGljIGZ1bmN0aW9uIGZvciBhZGRpbmcgbmV3IHBhcnNlcnMuIFlvdSBwYXNzIGl0IGEgdHlwZSBsaWtlICdmYWN0b3J5JyBhbmRcbi8vIGEgcGFyc2luZyBmdW5jdGlvbi4gVGhpcyBwYXJzaW5nIGZ1bmN0aW9uIGlzIHdoYXQgaXMgY2FsbGVkIGluIHRoZSBgRGVjb3JhdGVkTW9kdWxlLmFkZGBcbi8vIGZ1bmN0aW9uXG5Nb2R1bGUuYWRkUHJvdmlkZXIgPSBmdW5jdGlvbihwcm92aWRlclR5cGU6IHN0cmluZywgcGFyc2VyOiBhbnkpe1xuXHRfcGFyc2Vyc1twcm92aWRlclR5cGVdID0gcGFyc2VyO1xufTtcblxuLy8gUmV0cmlldmUgYSBwYXJzZXIuIE9ubHkgdXNlZnVsIGZvciB0ZXN0cyBhbmQgY2hlY2tpbmcgaWYgYSBwYXJzZXIgaGFzIGFscmVhZHkgYmVlblxuLy8gc2V0XG5Nb2R1bGUuZ2V0UGFyc2VyID0gZnVuY3Rpb24ocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBhbnl7XG5cdHJldHVybiBfcGFyc2Vyc1twcm92aWRlclR5cGVdO1xufTtcblxuLy8gIyMgQ29uY2x1c2lvblxuLy8gRmluYWxseSBleHBvcnQgbW9kdWxlXG5leHBvcnQgZGVmYXVsdCBNb2R1bGU7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
